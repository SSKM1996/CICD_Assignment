
on:
  workflow_run:
    workflows: ["Train"]
    types: 
      - completed

jobs:
  on-success:
    pull-and-run: 
    if: ${{ github.event.workflow_run.conclusion == 'success' }}

    runs-on: ubuntu-latest
    steps:
      - name: Pulling image from docker
        run: docker pull sskm1996/assign_cicd:latest

      - name: Running image and verifying the score
        run: |
          value=$(docker run sskm1996/assign_cicd:latest python3 test.py | tail -n 1)
          echo "$value"
          if (( $(echo "$value > 0.35" | bc -l) )); then
            echo "Score is more than 0.35, pass...."
          else
            echo "Score is not more than 0.35, job is failed."
            exit 1
   on-failure:
      if: ${{ github.event.workflow_run.conclusion == 'failure' }}

      runs-on: ubuntu-latest
         echo "Train workflow is failed"
         exit 1
